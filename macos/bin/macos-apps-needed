#! /usr/bin/env swift

import Foundation

let needApps = [
  "1Blocker",
  "1Password for Safari",
  "1Password",
  "Amazon Kindle",
  "Arq",
  "Claude",
  "Discord",
  "Discovery",
  "Endel",
  "Flighty",
  "GitHub Desktop",
  "HomePass",
  "Kagi for Safari",
  "Linear",
  "LZ Virtual Mail",
  "Marked 2",
  "MEATER",
  "Numbers",
  "OmniFocus",
  "OrbStack",
  "Pages",
  "Paprika Recipe Manager 3",
  "ParentSquare",
  "Pixelmator Pro",
  "Reeder",
  "Signal",
  "Slack",
  "Soulver 3",
  "StopTheMadness Pro",
  "Tailscale",
  "Visual Studio Code",
  "Xcode",
  "zoom.us",
  ]
var needApplications = Set(needApps)
let fileManager = FileManager.default
let applicationDirectories = fileManager.urls(for: .applicationDirectory,
                                               in: [.localDomainMask, .userDomainMask])
var installedApplications = Set<String>()
for dir in applicationDirectories {
    let applications = try fileManager.contentsOfDirectory(at: dir,
                                                           includingPropertiesForKeys: nil,
                                                           options: [])
    for app in applications {
      let appName = app.deletingPathExtension().lastPathComponent
      installedApplications.insert(appName)
    }
}
needApplications.subtract(installedApplications)
print(needApplications)
