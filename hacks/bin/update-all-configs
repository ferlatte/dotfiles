#! /bin/bash

set -eu -o pipefail

pushd ~/dotfiles > /dev/null
git pull
stow [a-z]*
popd

pushd ~/.bash_it > /dev/null
git pull
popd

bash-it-configure

brew update
brew upgrade
brew cleanup

vagrant plugin update

open /Applications/Emacs.app

# HACK: Really, we should use e --eval to poll to see when Emacs is ready.
sleep 10

# If you don't refresh package before updating prelude, prelude-update
# doesn't appear to reliably work.
# EMACS Prelude does it's own git update, followed by a ton of stuff
e --eval \
  '(package-refresh-contents)' \
  '(prelude-update)'

# This can take a long time, but I don't think there's a better way?
vagrant box update
