#! /usr/bin/env bash

set -eu -o pipefail

function inpath {
    command -v "$1" > /dev/null
}

pushd ~/.dotfiles > /dev/null
git pull
make install
# This is handled by pre-commit.ci
# pre-commit autoupdate
popd > /dev/null

macos-set-defaults
macos-enable-sudo-touchid

bash_it="${BASH_IT:-}"
if [ -n "$bash_it" ]; then
    bash-it-configure
fi

if inpath brew; then
    brewup
fi

asdfup

# NumPy makes gcloud ssh go much faster
if inpath gcloud; then
    $(gcloud info --format="value(basic.python_location)") -m pip install numpy
fi

if inpath vagrant; then
    vagrant plugin update
fi

echo "macOS apps needed:"
macos-apps-needed

if inpath softwareupdate; then
    softwareupdate --list
fi
